/*! For license information please see background.js.LICENSE.txt */
(()=>{"use strict";var e={713:(e,t)=>{Symbol.for("react.element"),Symbol.for("react.portal"),Symbol.for("react.fragment"),Symbol.for("react.strict_mode"),Symbol.for("react.profiler"),Symbol.for("react.provider"),Symbol.for("react.context"),Symbol.for("react.forward_ref"),Symbol.for("react.suspense"),Symbol.for("react.memo"),Symbol.for("react.lazy"),Symbol.iterator;var r={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},o=Object.assign,n={};function a(e,t,o){this.props=e,this.context=t,this.refs=n,this.updater=o||r}function s(){}function c(e,t,o){this.props=e,this.context=t,this.refs=n,this.updater=o||r}a.prototype.isReactComponent={},a.prototype.setState=function(e,t){if("object"!=typeof e&&"function"!=typeof e&&null!=e)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")},a.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")},s.prototype=a.prototype;var i=c.prototype=new s;i.constructor=c,o(i,a.prototype),i.isPureReactComponent=!0;Array.isArray,Object.prototype.hasOwnProperty},758:(e,t,r)=>{r(713)}},t={};!function(){function e(){this.logs=[],this.MAX_LOGS=1e3}e.getInstance=function(){return e.instance||(e.instance=new e),e.instance},e.prototype.getCallerInfo=function(){var e=(new Error).stack;if(e){var t=e.split("\n")[3];if(t){var r=t.match(/chrome-extension:\/\/[^/]+\/([^:]+):(\d+):(\d+)/);if(r)return{file:r[1],line:parseInt(r[2],10),column:parseInt(r[3],10)}}}},e.prototype.formatMessage=function(e,t,r){void 0===t&&(t={});var o=(new Date).toISOString(),n=t.group?"[".concat(t.group,"]"):"",a=r?"(".concat(r.file,":").concat(r.line,":").concat(r.column,")"):"";return"".concat(o," ").concat(n," ").concat(a," ").concat(e)},e.prototype.storeLog=function(e,t,r){if(void 0===r&&(r={}),r.persist){var o=this.getCallerInfo();this.logs.push({message:e,level:t,timestamp:Date.now(),group:r.group,caller:o}),this.logs.length>this.MAX_LOGS&&this.logs.shift()}},e.prototype.debug=function(e,t){void 0===t&&(t={});var r=this.getCallerInfo(),o=this.formatMessage(e,t,r);console.debug(o),this.storeLog(e,"debug",t)},e.prototype.info=function(e,t){void 0===t&&(t={});var r=this.getCallerInfo(),o=this.formatMessage(e,t,r);console.info(o),this.storeLog(e,"info",t)},e.prototype.warn=function(e,t){void 0===t&&(t={});var r=this.getCallerInfo(),o=this.formatMessage(e,t,r);console.warn(o),this.storeLog(e,"warn",t)},e.prototype.error=function(e,t){void 0===t&&(t={});var r=this.getCallerInfo(),o=this.formatMessage(e,t,r);console.error(o),this.storeLog(e,"error",t)},e.prototype.getLogs=function(){return this.logs},e.prototype.clearLogs=function(){this.logs=[]}}();var r=function(){},o=function(){},n=(function r(o){var n=t[o];if(void 0!==n)return n.exports;var a=t[o]={exports:{}};return e[o](a,a.exports,r),a.exports}(758),function(e,t,r,o){return new(r||(r=Promise))((function(n,a){function s(e){try{i(o.next(e))}catch(e){a(e)}}function c(e){try{i(o.throw(e))}catch(e){a(e)}}function i(e){var t;e.done?n(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(s,c)}i((o=o.apply(e,t||[])).next())}))}),a=function(e,t,r,o){return new(r||(r=Promise))((function(n,a){function s(e){try{i(o.next(e))}catch(e){a(e)}}function c(e){try{i(o.throw(e))}catch(e){a(e)}}function i(e){var t;e.done?n(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(s,c)}i((o=o.apply(e,t||[])).next())}))},s=function(e,t){var r,o,n,a={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]},s=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return s.next=c(0),s.throw=c(1),s.return=c(2),"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s;function c(c){return function(i){return function(c){if(r)throw new TypeError("Generator is already executing.");for(;s&&(s=0,c[0]&&(a=0)),a;)try{if(r=1,o&&(n=2&c[0]?o.return:c[0]?o.throw||((n=o.return)&&n.call(o),0):o.next)&&!(n=n.call(o,c[1])).done)return n;switch(o=0,n&&(c=[2&c[0],n.value]),c[0]){case 0:case 1:n=c;break;case 4:return a.label++,{value:c[1],done:!1};case 5:a.label++,o=c[1],c=[0];continue;case 7:c=a.ops.pop(),a.trys.pop();continue;default:if(!((n=(n=a.trys).length>0&&n[n.length-1])||6!==c[0]&&2!==c[0])){a=0;continue}if(3===c[0]&&(!n||c[1]>n[0]&&c[1]<n[3])){a.label=c[1];break}if(6===c[0]&&a.label<n[1]){a.label=n[1],n=c;break}if(n&&a.label<n[2]){a.label=n[2],a.ops.push(c);break}n[2]&&a.ops.pop(),a.trys.pop();continue}c=t.call(e,a)}catch(e){c=[6,e],o=0}finally{r=n=0}if(5&c[0])throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}([c,i])}}};r("Starting background script",{group:"background",persist:!0}),chrome.runtime.onInstalled.addListener((function(e){return a(void 0,void 0,void 0,(function(){return s(this,(function(t){switch(t.label){case 0:return r("Extension installed",{group:"background",persist:!0}),[4,a(void 0,void 0,void 0,(function(){return s(this,(function(e){switch(e.label){case 0:return[4,a(void 0,void 0,void 0,(function(){return s(this,(function(e){switch(e.label){case 0:return e.trys.push([0,5,,6]),[4,chrome.offscreen.hasDocument()];case 1:return e.sent()?[4,chrome.offscreen.closeDocument()]:[3,3];case 2:e.sent(),e.label=3;case 3:return[4,chrome.offscreen.createDocument({url:"offscreen.html",reasons:["DOM_PARSER"],justification:"Detect system color scheme changes"})];case 4:return e.sent(),r("Offscreen document created successfully",{group:"background",persist:!0}),[3,6];case 5:return e.sent(),o("Failed to create offscreen document",{group:"background",persist:!0}),[3,6];case 6:return[2]}}))}))];case 1:return e.sent(),[2]}}))}))];case 1:t.sent(),t.label=2;case 2:return t.trys.push([2,6,,7]),"install"!==e.reason?[3,5]:(r("Starting storage clear",{group:"background",persist:!0}),[4,new Promise((function(e,t){chrome.storage.local.clear((function(){chrome.runtime.lastError?(o("Error clearing storage",{group:"background",persist:!0}),t(chrome.runtime.lastError)):(r("Storage cleared",{group:"background",persist:!0}),e())}))}))]);case 3:return t.sent(),[4,(r("Creating default profile",{group:"background",persist:!0}),new Promise((function(e,t){chrome.management.getAll((function(n){r("Got extensions",{group:"background",persist:!0});var a=n.map((function(e){return{id:e.id,enabled:e.enabled}})),s=(new Date).toISOString(),c={profiles:[{id:crypto.randomUUID?crypto.randomUUID():Math.random().toString(36).slice(2),name:"Default",extensions:a,createdAt:s,updatedAt:s}],currentProfileId:null};r("Setting default profile",{group:"background",persist:!0}),chrome.storage.local.set({"extension-manager-profiles":c},(function(){chrome.runtime.lastError?(o("Error saving default profile",{group:"background",persist:!0}),t(chrome.runtime.lastError)):(r("Default profile saved to storage",{group:"background",persist:!0}),e())}))}))})))];case 4:t.sent(),t.label=5;case 5:return r("Installation process completed",{group:"background",persist:!0}),[3,7];case 6:return t.sent(),o("Error during installation",{group:"background",persist:!0}),[3,7];case 7:return[2]}}))}))})),chrome.management.onEnabled.addListener((function(e){r("Extension enabled: ".concat(e.name),{group:"background",persist:!0})})),chrome.management.onDisabled.addListener((function(e){r("Extension disabled: ".concat(e.name),{group:"background",persist:!0})})),chrome.runtime.onMessage.addListener((function(e,t,a){return r("Received message",{group:"background",persist:!0}),"COLOR_SCHEME_CHANGED"===e.type&&(r("Color scheme changed",{group:"background",persist:!0}),s=e.isDarkMode,n(void 0,void 0,void 0,(function(){var e;return function(e,t){var r,o,n,a={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]},s=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return s.next=c(0),s.throw=c(1),s.return=c(2),"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s;function c(c){return function(i){return function(c){if(r)throw new TypeError("Generator is already executing.");for(;s&&(s=0,c[0]&&(a=0)),a;)try{if(r=1,o&&(n=2&c[0]?o.return:c[0]?o.throw||((n=o.return)&&n.call(o),0):o.next)&&!(n=n.call(o,c[1])).done)return n;switch(o=0,n&&(c=[2&c[0],n.value]),c[0]){case 0:case 1:n=c;break;case 4:return a.label++,{value:c[1],done:!1};case 5:a.label++,o=c[1],c=[0];continue;case 7:c=a.ops.pop(),a.trys.pop();continue;default:if(!((n=(n=a.trys).length>0&&n[n.length-1])||6!==c[0]&&2!==c[0])){a=0;continue}if(3===c[0]&&(!n||c[1]>n[0]&&c[1]<n[3])){a.label=c[1];break}if(6===c[0]&&a.label<n[1]){a.label=n[1],n=c;break}if(n&&a.label<n[2]){a.label=n[2],a.ops.push(c);break}n[2]&&a.ops.pop(),a.trys.pop();continue}c=t.call(e,a)}catch(e){c=[6,e],o=0}finally{r=n=0}if(5&c[0])throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}([c,i])}}}(this,(function(t){switch(t.label){case 0:r("Updating extension icon",{group:"background",persist:!0}),t.label=1;case 1:return t.trys.push([1,3,,4]),e=s?"/icons/dark/":"/icons/light/",[4,chrome.action.setIcon({path:{16:"".concat(e,"icon16.png"),48:"".concat(e,"icon48.png"),128:"".concat(e,"icon128.png")}})];case 2:return t.sent(),r("Icon updated",{group:"background",persist:!0}),[3,4];case 3:return t.sent(),o("Failed to update extension icon",{group:"background",persist:!0}),[3,4];case 4:return[2]}}))})),a({success:!0})),!0;var s}))})();